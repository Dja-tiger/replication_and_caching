# Заголовки для работы с CDN
location /static/ {
    # Долгий кэш для CDN
    expires 365d;
    add_header Cache-Control "public, immutable";

    # Версионирование через имя файла
    location ~ "\.[a-f0-9]{8}\.(css|js)$" {
        expires max;
    }

    # CORS для CDN
    add_header Access-Control-Allow-Origin "*";

    # Подсказки для предзагрузки
    add_header Link "</css/main.css>; rel=preload; as=style";

    # Защита от hotlinking
    valid_referers none blocked technomir.ru *.technomir.ru;
    if ($invalid_referer) {
        return 403;
    }
}